<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TODOアプリ</title>
<style>
    body {
        font-family: 'Noto Sans JP', sans-serif;
        background-color: #0d0d0d;
        color: #eee;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
    }

    h1 {
        color: #f0f0f0;
        font-weight: 800;
        letter-spacing: 1px;
        margin-top: 40px;
        margin-bottom: 30px;
        border-bottom: 2px solid #330066;
        padding-bottom: 10px;
    }

    section.card {
        background: #1a1a1a;
        padding: 25px 30px;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.7);
        width: 90%;
        max-width: 700px;
        margin-bottom: 30px;
        transition: transform 0.2s;
    }

    section.card:hover {
        transform: translateY(-3px);
    }

    h2.section-title {
        margin-top: 0;
        margin-bottom: 15px;
        font-weight: 700;
        color: #ddd;
    }

    form {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
    }

    input[type="text"], input[type="date"] {
        padding: 12px;
        border: none;
        border-radius: 10px;
        background-color: #2a2a2a;
        color: #fff;
        flex: 1 1 150px;
        transition: background 0.2s, box-shadow 0.2s;
    }

    input[type="text"]:focus, input[type="date"]:focus {
        outline: none;
        background-color: #3a2a5c;
        box-shadow: 0 0 8px rgba(155,48,255,0.5);
    }

    input[type="submit"], button {
        background: linear-gradient(135deg, #6a0dad, #9b30ff);
        color: #fff;
        border: none;
        padding: 12px 18px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
    }

    input[type="submit"]:hover, button:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 15px rgba(155,48,255,0.5);
    }

    .filter-links {
        margin-bottom: 15px;
    }

    .filter-links a {
        text-decoration: none;
        color: #bb66ff;
        margin-right: 12px;
        font-weight: 500;
    }

    .filter-links a.active {
        border-bottom: 2px solid #9b30ff;
    }

    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 10px; /* 行間を空けて見やすく */
        margin-top: 15px;
    }

    thead th {
        padding: 12px 15px;
        background-color: #2a1a3f;
        color: #fff;
        text-align: left;
        border-radius: 8px;
    }

    tbody tr {
        background: #2b2b2b; /* 少し明るめで文字を目立たせる */
        color: #fff;
        border-radius: 10px;
        display: table-row;
        transition: background 0.2s, transform 0.2s;
    }

    tbody tr:hover {
        background: #3a2a5c; /* 紫系ホバー */
        transform: translateY(-2px);
    }

    tbody td {
        padding: 12px 15px;
    }

    .status {
        padding: 6px 12px;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 600;
    }

    .status-done {
        background-color: #6a0dad;
        color: #fff;
    }

    .status-todo {
        background-color: #9b30ff;
        color: #fff;
    }

    .btn {
        text-decoration: none;
        color: #fff;
        background-color: #444;
        padding: 6px 12px;
        border-radius: 8px;
        font-size: 0.9rem;
        transition: all 0.2s;
    }

    .btn:hover {
        background-color: #6a0dad;
        transform: scale(1.05);
    }

    .completed {
        text-decoration: line-through;
        color: #bbb; /* 完了タスクは少し薄め */
    }

    footer {
        margin-top: auto;
        padding: 15px;
        font-size: 0.85rem;
        color: #777;
    }

    @media (max-width: 600px) {
        input[type="text"], input[type="date"], button {
            flex: 1 1 100%;
        }
    }
</style>
</head>
<body>
<h1>TODOアプリ</h1>

<section class="card">
    <h2 class="section-title">新しいタスクを追加</h2>
    <form method="post" action="{% url 'work09:create' %}">
        {% csrf_token %}
        <input type="text" name="title" placeholder="タスク名を入力してください" required>
        <input type="date" name="due_date">
        <input type="submit" value="登録">
    </form>
</section>

<section class="card">
    <h2 class="section-title">TODO一覧</h2>

    <div class="filter-links">
        <a href="{% url 'work09:todo_list' %}" class="active">全て</a>
        <a href="?incomplete=1">未完了のみ</a>
        <a href="?completed=1">完了済みのみ</a>
    </div>

    <table>
        <thead>
            <tr>
                <th>完了状況</th>
                <th>タスク名</th>
                <th>期限日</th>
                <th>登録日</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for todo in todos %}
            <tr class="{% if todo.is_completed %}completed-row{% elif todo.due_date < today %}overdue-row{% endif %}">
                <td>
                    {% if todo.is_completed %}
                        <span class="status status-done">完了</span>
                    {% else %}
                        <span class="status status-todo">未完了</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'work09:edit' todo.pk %}" class="{% if todo.is_completed %}completed{% endif %}">
                        {{ todo.title }}
                    </a>
                </td>
                <td>{{ todo.due_date|default:"－" }}</td>
                <td>{{ todo.created_at|date:"Y/m/d H:i" }}</td>
                <td>
                    {% if todo.is_completed %}
                        <a href="{% url 'work09:toggle' todo.pk %}" class="btn btn-reopen">未完了に戻す</a>
                    {% else %}
                        <a href="{% url 'work09:toggle' todo.pk %}" class="btn btn-done">完了</a>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="5">タスクはありません。</td></tr>
            {% endfor %}
        </tbody>
    </table>
</section>

<footer>© 2025 TODOアプリ</footer>
</body>
</html>
